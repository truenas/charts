#!/usr/bin/python3
import json
import os
import sys


def migrate(values):
    storageKey = 'minioLogging'
    storageSubKey = 'logsearch'
    storages = ['pgData', 'pgData']

    for storage in storages:
        if values.get(storageKey).get(storageSubKey).get(storage).get('type') == 'hostPath':
            continue

        values[storageKey][storageSubKey][storage] = {
            {key: value for key, value in values[storageKey][storageSubKey][storage].items() if key != 'hostPath'}
        }

    return values


if __name__ == '__main__':
    if len(sys.argv) != 2:
        exit(1)

    if os.path.exists(sys.argv[1]):
        with open(sys.argv[1], 'r') as f:
            print(json.dumps(migrate(json.loads(f.read()))))
