groups:
  - name: MinIO Configuration
    description: Configure MinIO
  - name: Storage
    description: Configure Storage

questions:
  - variable: minio
    label: MinIO Configuration
    group: MinIO Configuration
    schema:
      type: dict
      attrs:

        - variable: creds
          label: Credentials
          schema:
            type: dict
            attrs:
              - variable: root_user
                label: Root User
                description: The access key for the root user.
                schema:
                  type: string
                  min_length: 5
                  required: true
              - variable: root_pass
                label: Root Password
                description: The secret key for the root user.
                schema:
                  type: string
                  required: true
                  min_length: 8
                  private: true

        - variable: logging
          label: Logging
          schema:
            type: dict
            attrs:
              - variable: anonymous
                label: Anonymous
                description: Hides sensitive information from logging.
                schema:
                  type: boolean
                  default: false
              - variable: quiet
                label: Quiet
                description: Disables startup information.
                schema:
                  type: boolean
                  default: false

        - variable: storage
          label: Storage
          schema:
            type: dict
            attrs:
              - variable: data
                label: Data
                schema:
                  type: dict
                  attrs:
                    - variable: type
                      label: Type
                      schema:
                        type: string
                        immutable: true
                        required: true
                        default: ixVolume
                        enum:
                          - value: hostPath
                            description: Host Path
                          - value: ixVolume
                            description: ixVolume
                    - variable: hostPath
                      label: Host Path
                      description: The host path to use for storage.
                      schema:
                        type: path
                        required: true
                        immutable: true
                        show_if: [["type", "=", "hostPath"]]
                    - variable: datasetName
                      label: Dataset Name
                      description: The name of the dataset to use for storage.
                      schema:
                        type: string
                        show_if: [["type", "=", "ixVolume"]]
                        required: true
                        hidden: true
                        editable: false
                        default: ix-minio
                        $ref:
                          - "normalize/ixVolume"

        - variable: network
          label: Network
          schema:
            type: dict
            attrs:
              - variable: api_port
                label: API Port
                description: The port for the MinIO API.
                schema:
                  type: int
                  default: 30000
                  min: 9000
                  max: 65535
                  required: true
              - variable: web_port
                label: Web Port
                description: The port for the MinIO Web UI.
                schema:
                  type: int
                  default: 30001
                  min: 9000
                  max: 65535
                  required: true
              - variable: certificate_id
                label: Certificate
                description: The certificate to use for MinIO
                schema:
                  type: int
                  $ref:
                    - "definitions/certificate"
              - variable: domain
                label: Domain
                description: The domain of MinIO
                schema:
                  type: string
                  show_if: [["certificate_id", "!=", null]]
                  required: true
              - variable: distributed_mode
                label: Distributed Mode
                description: Enable distributed mode for MinIO
                schema:
                  type: boolean
                  default: false
                  show_subquestions_if: true
                  subquestions:
                    - variable: distributed_addresses
                      label: Distributed Addresses
                      schema:
                        type: list
                        default: []
                        items:
                          - variable: address
                            label: Address
                            schema:
                              type: string
                              required: true
